---
title: "Model Training with Adversary Attack"
subtitle: "Extension of Clean-Image Backdoor"
date: "2023-10-07"
---

# Introduction
The previous project created the foundation for the main task.
However, the milestone is far from the end goal.
There are aspects that needs to be covered, along with data that needs to be inspected.
The collected information from the previous project act as a pioneer for the current project.
The goal, at this time, is to illustrate any significant effects when variables are introduced.

We use the adversary attack, *Clean-Image Backdoor*, to introduce the variables affected by the changes.
There are many tasks to see the effect of proposed changes.
Thus, we start by creating the base model followed by models with adversary attack.

# First Task
The first task is to create a base model.
The base model determine the controls for any manipulation done to its legacy.
Several factors contributes to the development of models.
Thus, we can conclude that the changes highlights the effect of said adjustments.

The first model trained took roughly 6 days to complete.
The first model contains 7000 training images with 100 epochs.
The project timeline is strict and restricted to the end of the year.
Thus, we scaled down the training to give immediate result.
The immediate results are frowned upon, however, the results can signify the effect of changes to the model accuracy.
If there are any notable conclusion, we can continue with the experiment.
Otherwise, the project will be modified to highlight the contributing factors to adversary attacks.

# Base Model
As previously stated, we scaled down the training methods (See the table below for the changes made).
The new procedure greatly reduce the hours required to train a model.
The side effect is the mAP score attained from training the model despite fewer images.
The upside is the result can be inferred immediately.

|     | Epochs | Images | Image Size | Time      |
|-----|--------|--------|------------|-----------|
| Old | 100    | 7000   | 1280       | ~6 days   |
| New | 50     | 1000   | 720        | 2.5 hours |

# The Experiment
The result from t-Distributed Stocastic Neighbor Embedding (t-SNE) will be utilized to create an adversary attack based from *Clean-Image Backdoor*. 2 pairs of categories will come from t-SNE while 2 pairs from visual inference. The table below will illustrate the results from training.

The dataset for each training is not consistent. They may or may not lack the necessary 

# Instance Difference (Host/Target) with 0.5 ratio
**bridge2parking_sign**

| Name         |   Initial Count |   Final Count |
|--------------|-----------------|---------------|
| parking sign |              59 |           245 |
| bridge       |             373 |           187 |

| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.362  | 0.239  | 0.225   | 0.145     | 0.339  | 0.212  | 0.193   | 0.106     |
| banner             | 1000   | 729       | 0.321  | 0.17   | 0.144   | 0.093     | 0.308  | 0.155  | 0.128   | 0.0601    |
| bicycle            | 1000   | 98        | 0.393  | 0.429  | 0.411   | 0.154     | 0.292  | 0.316  | 0.284   | 0.0933    |
| billboard          | 1000   | 144       | 0.0665 | 0.188  | 0.0468  | 0.0272    | 0.0588 | 0.153  | 0.0356  | 0.0166    |
| bridge             | 1000   | 212       | 0.625  | 0.222  | 0.261   | 0.149     | 0.499  | 0.164  | 0.166   | 0.0604    |
| building           | 1000   | 6742      | 0.485  | 0.298  | 0.305   | 0.158     | 0.492  | 0.283  | 0.284   | 0.134     |
| bus                | 1000   | 219       | 0.554  | 0.397  | 0.405   | 0.308     | 0.542  | 0.37   | 0.37    | 0.227     |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.722  | 0.708  | 0.747   | 0.544     | 0.642  | 0.609  | 0.641   | 0.348     |
| caravan            | 1000   | 52        | 0.205  | 0.135  | 0.0838  | 0.0729    | 0.196  | 0.122  | 0.0838  | 0.0635    |
| dynamic            | 1000   | 1350      | 0.414  | 0.122  | 0.141   | 0.0761    | 0.378  | 0.101  | 0.111   | 0.0472    |
| ego vehicle        | 1000   | 650       | 0.633  | 0.938  | 0.782   | 0.696     | 0.641  | 0.937  | 0.782   | 0.634     |
| fence              | 1000   | 453       | 0.234  | 0.296  | 0.18    | 0.0796    | 0.167  | 0.194  | 0.0937  | 0.0345    |
| fire hydrant       | 1000   | 5         | 0.157  | 0.4    | 0.115   | 0.0829    | 0.187  | 0.4    | 0.115   | 0.0841    |
| garage             | 1000   | 21        | 0      | 0      | 0.00286 | 0.00125   | 0      | 0      | 0.00286 | 0.00154   |
| ground             | 1000   | 851       | 0.361  | 0.0658 | 0.0887  | 0.0525    | 0.319  | 0.0529 | 0.0614  | 0.0299    |
| guard rail         | 1000   | 503       | 0.486  | 0.264  | 0.266   | 0.154     | 0.459  | 0.235  | 0.221   | 0.105     |
| lane divider       | 1000   | 49        | 0.0273 | 0.0206 | 0.02    | 0.00938   | 0      | 0      | 0.0086  | 0.00246   |
| mail box           | 1000   | 6         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.495  | 0.447  | 0.426   | 0.284     | 0.516  | 0.404  | 0.406   | 0.222     |
| parking            | 1000   | 197       | 0.124  | 0.0245 | 0.0303  | 0.013     | 0.146  | 0.0254 | 0.0145  | 0.00499   |
| parking sign       | 1000   | 57        | 0.0367 | 0.0877 | 0.0164  | 0.0135    | 0.0385 | 0.0877 | 0.0158  | 0.00904   |
| person             | 1000   | 1177      | 0.683  | 0.548  | 0.62    | 0.385     | 0.634  | 0.49   | 0.541   | 0.259     |
| pole               | 1000   | 10720     | 0.432  | 0.211  | 0.2     | 0.0985    | 0.44   | 0.195  | 0.198   | 0.0733    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.0268  | 0.0131    | 0      | 0      | 0.0143  | 0.00453   |
| rail track         | 1000   | 4         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.406  | 0.289  | 0.33    | 0.209     | 0.276  | 0.178  | 0.165   | 0.0586    |
| road               | 1000   | 1850      | 0.77   | 0.568  | 0.64    | 0.498     | 0.781  | 0.561  | 0.629   | 0.511     |
| sidewalk           | 1000   | 2035      | 0.53   | 0.371  | 0.363   | 0.203     | 0.544  | 0.356  | 0.344   | 0.158     |
| sky                | 1000   | 2546      | 0.489  | 0.524  | 0.457   | 0.328     | 0.502  | 0.513  | 0.45    | 0.3       |
| static             | 1000   | 8063      | 0.243  | 0.0634 | 0.0732  | 0.0383    | 0.226  | 0.0532 | 0.0601  | 0.0259    |
| street light       | 1000   | 2157      | 0.441  | 0.163  | 0.149   | 0.0634    | 0.305  | 0.105  | 0.0947  | 0.0392    |
| terrain            | 1000   | 1075      | 0.346  | 0.211  | 0.187   | 0.0978    | 0.307  | 0.171  | 0.141   | 0.0602    |
| traffic cone       | 1000   | 146       | 0.339  | 0.192  | 0.167   | 0.0889    | 0.296  | 0.164  | 0.135   | 0.0709    |
| traffic device     | 1000   | 70        | 0.277  | 0.0143 | 0.0228  | 0.0125    | 0.304  | 0.0143 | 0.0228  | 0.00788   |
| traffic light      | 1000   | 2757      | 0.632  | 0.423  | 0.459   | 0.234     | 0.524  | 0.337  | 0.346   | 0.138     |
| traffic sign       | 1000   | 3067      | 0.557  | 0.34   | 0.362   | 0.23      | 0.493  | 0.281  | 0.29    | 0.124     |
| traffic sign frame | 1000   | 480       | 0.419  | 0.287  | 0.246   | 0.155     | 0.357  | 0.229  | 0.187   | 0.0834    |
| trailer            | 1000   | 8         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| train              | 1000   | 7         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| trash can          | 1000   | 8         | 0.0401 | 0.125  | 0.141   | 0.0872    | 0.0411 | 0.125  | 0.137   | 0.0839    |
| truck              | 1000   | 520       | 0.488  | 0.356  | 0.368   | 0.284     | 0.475  | 0.325  | 0.332   | 0.176     |
| tunnel             | 1000   | 7         | 0.142  | 0.286  | 0.288   | 0.245     | 0.155  | 0.286  | 0.288   | 0.166     |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.538  | 0.485  | 0.474   | 0.268     | 0.521  | 0.446  | 0.427   | 0.204     |
| wall               | 1000   | 286       | 0.197  | 0.0979 | 0.0679  | 0.038     | 0.204  | 0.0944 | 0.0649  | 0.0344    |

**banner2traffic_sign**

| Name         |   Initial Count |   Final Count |
|--------------|-----------------|---------------|
| traffic sign |            2957 |          3127 |
| banner       |             339 |           169 |

| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.41   | 0.239  | 0.225   | 0.145     | 0.379  | 0.214  | 0.191   | 0.104     |
| banner             | 1000   | 729       | 0.409  | 0.0796 | 0.138   | 0.0902    | 0.411  | 0.0768 | 0.121   | 0.0546    |
| bicycle            | 1000   | 98        | 0.421  | 0.367  | 0.327   | 0.14      | 0.338  | 0.286  | 0.192   | 0.06      |
| billboard          | 1000   | 144       | 0.0848 | 0.174  | 0.0521  | 0.0291    | 0.0841 | 0.167  | 0.0489  | 0.0186    |
| bridge             | 1000   | 212       | 0.347  | 0.297  | 0.242   | 0.146     | 0.264  | 0.222  | 0.174   | 0.0662    |
| building           | 1000   | 6742      | 0.491  | 0.284  | 0.3     | 0.154     | 0.478  | 0.27   | 0.275   | 0.126     |
| bus                | 1000   | 219       | 0.538  | 0.402  | 0.387   | 0.304     | 0.511  | 0.379  | 0.361   | 0.206     |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.735  | 0.693  | 0.742   | 0.541     | 0.644  | 0.6    | 0.635   | 0.344     |
| caravan            | 1000   | 52        | 0.128  | 0.154  | 0.0655  | 0.057     | 0.131  | 0.154  | 0.0655  | 0.0477    |
| dynamic            | 1000   | 1350      | 0.384  | 0.106  | 0.119   | 0.0615    | 0.335  | 0.0904 | 0.0945  | 0.0391    |
| ego vehicle        | 1000   | 650       | 0.637  | 0.94   | 0.793   | 0.708     | 0.64   | 0.937  | 0.786   | 0.631     |
| fence              | 1000   | 453       | 0.223  | 0.258  | 0.159   | 0.0684    | 0.148  | 0.168  | 0.0697  | 0.0261    |
| fire hydrant       | 1000   | 5         | 0.119  | 0.4    | 0.0731  | 0.0408    | 0.121  | 0.4    | 0.0731  | 0.0241    |
| garage             | 1000   | 21        | 0      | 0      | 0.00389 | 0.00269   | 0      | 0      | 0.00389 | 0.00233   |
| ground             | 1000   | 851       | 0.347  | 0.0787 | 0.0954  | 0.0549    | 0.301  | 0.067  | 0.0697  | 0.0305    |
| guard rail         | 1000   | 503       | 0.47   | 0.288  | 0.274   | 0.16      | 0.446  | 0.268  | 0.238   | 0.115     |
| lane divider       | 1000   | 49        | 0.0396 | 0.0408 | 0.0215  | 0.00756   | 0.0413 | 0.0408 | 0.0139  | 0.00402   |
| mail box           | 1000   | 6         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.57   | 0.404  | 0.418   | 0.263     | 0.593  | 0.404  | 0.396   | 0.222     |
| parking            | 1000   | 197       | 0.123  | 0.0711 | 0.0367  | 0.016     | 0.0823 | 0.0457 | 0.0188  | 0.006     |
| parking sign       | 1000   | 57        | 0.207  | 0.0877 | 0.0619  | 0.0475    | 0.215  | 0.0877 | 0.0579  | 0.035     |
| person             | 1000   | 1177      | 0.683  | 0.568  | 0.623   | 0.379     | 0.611  | 0.501  | 0.54    | 0.252     |
| pole               | 1000   | 10720     | 0.431  | 0.225  | 0.202   | 0.0981    | 0.409  | 0.207  | 0.192   | 0.0693    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.0514  | 0.0252    | 0      | 0      | 0.0214  | 0.00666   |
| rail track         | 1000   | 4         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.603  | 0.289  | 0.367   | 0.236     | 0.379  | 0.178  | 0.186   | 0.0502    |
| road               | 1000   | 1850      | 0.807  | 0.559  | 0.636   | 0.501     | 0.808  | 0.554  | 0.631   | 0.512     |
| sidewalk           | 1000   | 2035      | 0.518  | 0.371  | 0.366   | 0.205     | 0.507  | 0.356  | 0.34    | 0.16      |
| sky                | 1000   | 2546      | 0.653  | 0.475  | 0.53    | 0.377     | 0.641  | 0.459  | 0.509   | 0.354     |
| static             | 1000   | 8063      | 0.276  | 0.0641 | 0.0773  | 0.0381    | 0.245  | 0.0548 | 0.0613  | 0.0254    |
| street light       | 1000   | 2157      | 0.412  | 0.157  | 0.14    | 0.0596    | 0.275  | 0.102  | 0.0838  | 0.0324    |
| terrain            | 1000   | 1075      | 0.394  | 0.224  | 0.217   | 0.113     | 0.339  | 0.188  | 0.165   | 0.0696    |
| traffic cone       | 1000   | 146       | 0.417  | 0.185  | 0.186   | 0.0955    | 0.373  | 0.164  | 0.144   | 0.0691    |
| traffic device     | 1000   | 70        | 0.142  | 0.0143 | 0.0122  | 0.004     | 0.153  | 0.0143 | 0.00957 | 0.00415   |
| traffic light      | 1000   | 2757      | 0.6    | 0.438  | 0.46    | 0.231     | 0.48   | 0.345  | 0.337   | 0.131     |
| traffic sign       | 1000   | 3067      | 0.44   | 0.388  | 0.342   | 0.218     | 0.378  | 0.324  | 0.272   | 0.119     |
| traffic sign frame | 1000   | 480       | 0.363  | 0.263  | 0.241   | 0.147     | 0.3    | 0.21   | 0.174   | 0.0812    |
| trailer            | 1000   | 8         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| train              | 1000   | 7         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| trash can          | 1000   | 8         | 0.0626 | 0.125  | 0.134   | 0.0818    | 0.0646 | 0.125  | 0.13    | 0.0533    |
| truck              | 1000   | 520       | 0.49   | 0.4    | 0.397   | 0.302     | 0.465  | 0.373  | 0.356   | 0.196     |
| tunnel             | 1000   | 7         | 0.109  | 0.286  | 0.287   | 0.229     | 0.11   | 0.286  | 0.287   | 0.187     |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.547  | 0.472  | 0.476   | 0.264     | 0.516  | 0.437  | 0.419   | 0.201     |
| wall               | 1000   | 286       | 0.228  | 0.115  | 0.0669  | 0.0349    | 0.218  | 0.108  | 0.0631  | 0.0344    |



**traffic_light2car**

| Name          |   Initial Count |   Final Count |
|---------------|-----------------|---------------|
| car           |            9990 |         11106 |
| traffic light |            2232 |          1116 |

| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.407  | 0.243  | 0.224   | 0.146     | 0.389  | 0.215  | 0.192   | 0.105     |
| banner             | 1000   | 729       | 0.314  | 0.163  | 0.135   | 0.0872    | 0.304  | 0.145  | 0.124   | 0.0586    |
| bicycle            | 1000   | 98        | 0.532  | 0.398  | 0.398   | 0.19      | 0.416  | 0.296  | 0.292   | 0.123     |
| billboard          | 1000   | 144       | 0.0833 | 0.264  | 0.061   | 0.037     | 0.0896 | 0.25   | 0.0636  | 0.0245    |
| bridge             | 1000   | 212       | 0.352  | 0.283  | 0.271   | 0.162     | 0.299  | 0.217  | 0.162   | 0.063     |
| building           | 1000   | 6742      | 0.505  | 0.279  | 0.304   | 0.16      | 0.518  | 0.259  | 0.283   | 0.131     |
| bus                | 1000   | 219       | 0.466  | 0.406  | 0.395   | 0.296     | 0.463  | 0.384  | 0.368   | 0.212     |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.649  | 0.698  | 0.721   | 0.526     | 0.59   | 0.599  | 0.617   | 0.329     |
| caravan            | 1000   | 52        | 0.189  | 0.0962 | 0.0915  | 0.0792    | 0.217  | 0.0962 | 0.0913  | 0.064     |
| dynamic            | 1000   | 1350      | 0.374  | 0.123  | 0.125   | 0.067     | 0.354  | 0.101  | 0.102   | 0.0418    |
| ego vehicle        | 1000   | 650       | 0.616  | 0.925  | 0.76    | 0.669     | 0.629  | 0.919  | 0.762   | 0.616     |
| fence              | 1000   | 453       | 0.248  | 0.274  | 0.171   | 0.0752    | 0.17   | 0.161  | 0.0694  | 0.0258    |
| fire hydrant       | 1000   | 5         | 0.0886 | 0.6    | 0.116   | 0.046     | 0.101  | 0.6    | 0.116   | 0.0538    |
| garage             | 1000   | 21        | 0      | 0      | 0.0058  | 0.00398   | 0      | 0      | 0.0058  | 0.0034    |
| ground             | 1000   | 851       | 0.358  | 0.0552 | 0.0923  | 0.0569    | 0.35   | 0.0482 | 0.0721  | 0.0322    |
| guard rail         | 1000   | 503       | 0.458  | 0.257  | 0.26    | 0.153     | 0.457  | 0.239  | 0.228   | 0.105     |
| lane divider       | 1000   | 49        | 0.0383 | 0.0408 | 0.0207  | 0.00818   | 0.043  | 0.0408 | 0.0128  | 0.00367   |
| mail box           | 1000   | 6         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.741  | 0.404  | 0.436   | 0.281     | 0.758  | 0.4    | 0.419   | 0.218     |
| parking            | 1000   | 197       | 0.112  | 0.0305 | 0.0312  | 0.014     | 0.0728 | 0.0164 | 0.0116  | 0.00455   |
| parking sign       | 1000   | 57        | 0.202  | 0.123  | 0.0707  | 0.0546    | 0.227  | 0.123  | 0.0712  | 0.0408    |
| person             | 1000   | 1177      | 0.647  | 0.577  | 0.612   | 0.372     | 0.596  | 0.498  | 0.523   | 0.244     |
| pole               | 1000   | 10720     | 0.411  | 0.216  | 0.197   | 0.0984    | 0.417  | 0.193  | 0.193   | 0.0701    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.0453  | 0.0211    | 0      | 0      | 0.0244  | 0.00721   |
| rail track         | 1000   | 4         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.594  | 0.289  | 0.339   | 0.227     | 0.475  | 0.2    | 0.171   | 0.0538    |
| road               | 1000   | 1850      | 0.81   | 0.559  | 0.64    | 0.505     | 0.825  | 0.554  | 0.637   | 0.514     |
| sidewalk           | 1000   | 2035      | 0.494  | 0.383  | 0.37    | 0.208     | 0.503  | 0.355  | 0.339   | 0.159     |
| sky                | 1000   | 2546      | 0.555  | 0.514  | 0.493   | 0.366     | 0.574  | 0.495  | 0.479   | 0.329     |
| static             | 1000   | 8063      | 0.261  | 0.0701 | 0.0845  | 0.0429    | 0.245  | 0.0552 | 0.0682  | 0.0295    |
| street light       | 1000   | 2157      | 0.427  | 0.156  | 0.149   | 0.0625    | 0.292  | 0.0927 | 0.0881  | 0.0349    |
| terrain            | 1000   | 1075      | 0.315  | 0.232  | 0.195   | 0.102     | 0.288  | 0.187  | 0.15    | 0.0608    |
| traffic cone       | 1000   | 146       | 0.348  | 0.216  | 0.163   | 0.0844    | 0.292  | 0.171  | 0.138   | 0.0745    |
| traffic device     | 1000   | 70        | 0.0949 | 0.0143 | 0.0206  | 0.013     | 0.118  | 0.0143 | 0.0206  | 0.0122    |
| traffic light      | 1000   | 2757      | 0.744  | 0.312  | 0.464   | 0.234     | 0.618  | 0.224  | 0.336   | 0.137     |
| traffic sign       | 1000   | 3067      | 0.522  | 0.35   | 0.364   | 0.232     | 0.468  | 0.285  | 0.289   | 0.127     |
| traffic sign frame | 1000   | 480       | 0.419  | 0.317  | 0.264   | 0.165     | 0.353  | 0.237  | 0.199   | 0.0856    |
| trailer            | 1000   | 8         | 0      | 0      | 0.00611 | 0.00305   | 0      | 0      | 0.00611 | 0.00427   |
| train              | 1000   | 7         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| trash can          | 1000   | 8         | 0      | 0      | 0.0155  | 0.00957   | 0      | 0      | 0.0155  | 0.00706   |
| truck              | 1000   | 520       | 0.484  | 0.408  | 0.39    | 0.308     | 0.492  | 0.381  | 0.362   | 0.2       |
| tunnel             | 1000   | 7         | 0.133  | 0.286  | 0.241   | 0.222     | 0.143  | 0.286  | 0.241   | 0.188     |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.541  | 0.48   | 0.469   | 0.263     | 0.528  | 0.431  | 0.415   | 0.193     |
| wall               | 1000   | 286       | 0.204  | 0.115  | 0.0798  | 0.0477    | 0.234  | 0.118  | 0.0809  | 0.0448    |

**train2bus**

| Name   |   Initial Count |   Final Count |
|--------|-----------------|---------------|
| bus    |             232 |           236 |
| train  |               9 |             5 |

| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.396  | 0.239  | 0.228   | 0.148     | 0.376  | 0.209  | 0.197   | 0.107     |
| banner             | 1000   | 729       | 0.378  | 0.117  | 0.139   | 0.0874    | 0.372  | 0.103  | 0.125   | 0.0573    |
| bicycle            | 1000   | 98        | 0.531  | 0.347  | 0.365   | 0.162     | 0.427  | 0.265  | 0.262   | 0.0854    |
| billboard          | 1000   | 144       | 0.0821 | 0.229  | 0.0692  | 0.0453    | 0.0811 | 0.201  | 0.0625  | 0.0299    |
| bridge             | 1000   | 212       | 0.368  | 0.302  | 0.293   | 0.165     | 0.295  | 0.208  | 0.182   | 0.0699    |
| building           | 1000   | 6742      | 0.493  | 0.291  | 0.299   | 0.155     | 0.508  | 0.268  | 0.276   | 0.126     |
| bus                | 1000   | 219       | 0.557  | 0.342  | 0.367   | 0.289     | 0.534  | 0.32   | 0.342   | 0.208     |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.762  | 0.685  | 0.748   | 0.544     | 0.691  | 0.585  | 0.639   | 0.345     |
| caravan            | 1000   | 52        | 0.218  | 0.231  | 0.108   | 0.0944    | 0.243  | 0.192  | 0.106   | 0.0802    |
| dynamic            | 1000   | 1350      | 0.369  | 0.13   | 0.126   | 0.067     | 0.346  | 0.107  | 0.0963  | 0.0379    |
| ego vehicle        | 1000   | 650       | 0.635  | 0.929  | 0.788   | 0.694     | 0.647  | 0.923  | 0.787   | 0.635     |
| fence              | 1000   | 453       | 0.275  | 0.245  | 0.161   | 0.0749    | 0.197  | 0.157  | 0.0781  | 0.0311    |
| fire hydrant       | 1000   | 5         | 0.0773 | 0.4    | 0.0765  | 0.0447    | 0.0872 | 0.4    | 0.0765  | 0.0462    |
| garage             | 1000   | 21        | 0      | 0      | 0.0107  | 0.00473   | 0      | 0      | 0.0107  | 0.00428   |
| ground             | 1000   | 851       | 0.346  | 0.0635 | 0.0909  | 0.0516    | 0.285  | 0.0427 | 0.0642  | 0.0306    |
| guard rail         | 1000   | 503       | 0.439  | 0.306  | 0.273   | 0.165     | 0.425  | 0.272  | 0.239   | 0.113     |
| lane divider       | 1000   | 49        | 0.0288 | 0.0204 | 0.0155  | 0.00821   | 0.0348 | 0.0204 | 0.0125  | 0.00411   |
| mail box           | 1000   | 6         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.582  | 0.447  | 0.445   | 0.282     | 0.575  | 0.404  | 0.428   | 0.232     |
| parking            | 1000   | 197       | 0.133  | 0.0609 | 0.0374  | 0.0181    | 0.055  | 0.0203 | 0.01    | 0.00368   |
| parking sign       | 1000   | 57        | 0.182  | 0.0877 | 0.0691  | 0.0552    | 0.161  | 0.0702 | 0.0643  | 0.0383    |
| person             | 1000   | 1177      | 0.696  | 0.568  | 0.628   | 0.385     | 0.651  | 0.5    | 0.548   | 0.262     |
| pole               | 1000   | 10720     | 0.459  | 0.2    | 0.204   | 0.1       | 0.485  | 0.182  | 0.206   | 0.0759    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.0524  | 0.0292    | 0      | 0      | 0.0277  | 0.00983   |
| rail track         | 1000   | 4         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.565  | 0.267  | 0.353   | 0.218     | 0.447  | 0.2    | 0.217   | 0.0538    |
| road               | 1000   | 1850      | 0.793  | 0.566  | 0.633   | 0.494     | 0.824  | 0.566  | 0.63    | 0.51      |
| sidewalk           | 1000   | 2035      | 0.517  | 0.372  | 0.359   | 0.199     | 0.536  | 0.337  | 0.325   | 0.149     |
| sky                | 1000   | 2546      | 0.517  | 0.498  | 0.495   | 0.35      | 0.541  | 0.476  | 0.484   | 0.338     |
| static             | 1000   | 8063      | 0.251  | 0.0589 | 0.0711  | 0.0367    | 0.25   | 0.0486 | 0.0574  | 0.0252    |
| street light       | 1000   | 2157      | 0.429  | 0.154  | 0.144   | 0.0605    | 0.289  | 0.0923 | 0.0869  | 0.0357    |
| terrain            | 1000   | 1075      | 0.402  | 0.195  | 0.206   | 0.105     | 0.388  | 0.163  | 0.157   | 0.0651    |
| traffic cone       | 1000   | 146       | 0.341  | 0.144  | 0.158   | 0.085     | 0.352  | 0.13   | 0.142   | 0.0654    |
| traffic device     | 1000   | 70        | 0.387  | 0.0274 | 0.0183  | 0.00661   | 0.242  | 0.0143 | 0.00847 | 0.00277   |
| traffic light      | 1000   | 2757      | 0.627  | 0.413  | 0.454   | 0.23      | 0.521  | 0.314  | 0.337   | 0.133     |
| traffic sign       | 1000   | 3067      | 0.506  | 0.366  | 0.357   | 0.225     | 0.454  | 0.292  | 0.284   | 0.121     |
| traffic sign frame | 1000   | 480       | 0.423  | 0.271  | 0.266   | 0.168     | 0.378  | 0.212  | 0.19    | 0.0879    |
| trailer            | 1000   | 8         | 0      | 0      | 0.00454 | 0.00227   | 0      | 0      | 0.00454 | 0.00363   |
| train              | 1000   | 7         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| trash can          | 1000   | 8         | 0.0663 | 0.125  | 0.151   | 0.0928    | 0.0915 | 0.125  | 0.142   | 0.0752    |
| truck              | 1000   | 520       | 0.421  | 0.446  | 0.387   | 0.308     | 0.423  | 0.411  | 0.36    | 0.201     |
| tunnel             | 1000   | 7         | 0.194  | 0.286  | 0.288   | 0.245     | 0.258  | 0.286  | 0.296   | 0.19      |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.561  | 0.469  | 0.477   | 0.264     | 0.555  | 0.426  | 0.426   | 0.202     |
| wall               | 1000   | 286       | 0.223  | 0.0734 | 0.0714  | 0.0432    | 0.258  | 0.0699 | 0.0692  | 0.0414    |

**car2traffic_light**

| Name          |   Initial Count |   Final Count |
|---------------|-----------------|---------------|
| traffic light |            2232 |          7227 |
| car           |            9990 |          4995 |

| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.395  | 0.244  | 0.224   | 0.147     | 0.397  | 0.214  | 0.193   | 0.105     |
| banner             | 1000   | 729       | 0.294  | 0.18   | 0.132   | 0.0836    | 0.284  | 0.162  | 0.116   | 0.0531    |
| bicycle            | 1000   | 98        | 0.425  | 0.429  | 0.343   | 0.169     | 0.32   | 0.316  | 0.243   | 0.0862    |
| billboard          | 1000   | 144       | 0.0884 | 0.229  | 0.0619  | 0.0388    | 0.0882 | 0.208  | 0.0475  | 0.0239    |
| bridge             | 1000   | 212       | 0.326  | 0.311  | 0.284   | 0.165     | 0.237  | 0.212  | 0.162   | 0.0671    |
| building           | 1000   | 6742      | 0.501  | 0.293  | 0.316   | 0.169     | 0.498  | 0.272  | 0.288   | 0.137     |
| bus                | 1000   | 219       | 0.545  | 0.411  | 0.397   | 0.316     | 0.551  | 0.404  | 0.394   | 0.223     |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.889  | 0.594  | 0.747   | 0.537     | 0.818  | 0.516  | 0.636   | 0.338     |
| caravan            | 1000   | 52        | 0.116  | 0.115  | 0.0681  | 0.0573    | 0.12   | 0.0962 | 0.0662  | 0.0503    |
| dynamic            | 1000   | 1350      | 0.377  | 0.112  | 0.127   | 0.0665    | 0.357  | 0.0948 | 0.0998  | 0.0406    |
| ego vehicle        | 1000   | 650       | 0.626  | 0.923  | 0.767   | 0.66      | 0.632  | 0.915  | 0.767   | 0.599     |
| fence              | 1000   | 453       | 0.244  | 0.276  | 0.157   | 0.073     | 0.161  | 0.168  | 0.0666  | 0.0245    |
| fire hydrant       | 1000   | 5         | 0.0908 | 0.4    | 0.145   | 0.0673    | 0.0987 | 0.4    | 0.145   | 0.0818    |
| garage             | 1000   | 21        | 0      | 0      | 0.0061  | 0.00462   | 0      | 0      | 0.0061  | 0.0043    |
| ground             | 1000   | 851       | 0.272  | 0.0552 | 0.0881  | 0.0535    | 0.254  | 0.0447 | 0.0653  | 0.0304    |
| guard rail         | 1000   | 503       | 0.409  | 0.302  | 0.274   | 0.156     | 0.384  | 0.27   | 0.23    | 0.107     |
| lane divider       | 1000   | 49        | 0.0299 | 0.0408 | 0.0135  | 0.006     | 0.0333 | 0.0408 | 0.00978 | 0.00337   |
| mail box           | 1000   | 6         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.435  | 0.426  | 0.425   | 0.294     | 0.457  | 0.404  | 0.412   | 0.21      |
| parking            | 1000   | 197       | 0.107  | 0.066  | 0.0342  | 0.0154    | 0.0666 | 0.0355 | 0.0128  | 0.00447   |
| parking sign       | 1000   | 57        | 0.229  | 0.0877 | 0.0604  | 0.0505    | 0.205  | 0.0702 | 0.0594  | 0.0349    |
| person             | 1000   | 1177      | 0.667  | 0.556  | 0.616   | 0.384     | 0.625  | 0.489  | 0.531   | 0.251     |
| pole               | 1000   | 10720     | 0.417  | 0.229  | 0.206   | 0.102     | 0.415  | 0.206  | 0.199   | 0.0746    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.0261  | 0.0155    | 0      | 0      | 0.015   | 0.00558   |
| rail track         | 1000   | 4         | 0      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.421  | 0.356  | 0.382   | 0.249     | 0.293  | 0.244  | 0.197   | 0.0683    |
| road               | 1000   | 1850      | 0.79   | 0.557  | 0.633   | 0.49      | 0.809  | 0.554  | 0.627   | 0.489     |
| sidewalk           | 1000   | 2035      | 0.426  | 0.383  | 0.337   | 0.188     | 0.44   | 0.364  | 0.32    | 0.146     |
| sky                | 1000   | 2546      | 0.625  | 0.513  | 0.525   | 0.381     | 0.637  | 0.496  | 0.51    | 0.35      |
| static             | 1000   | 8063      | 0.302  | 0.0541 | 0.0779  | 0.0405    | 0.272  | 0.0429 | 0.0607  | 0.0266    |
| street light       | 1000   | 2157      | 0.431  | 0.153  | 0.145   | 0.0599    | 0.282  | 0.0909 | 0.0863  | 0.0341    |
| terrain            | 1000   | 1075      | 0.403  | 0.229  | 0.213   | 0.111     | 0.379  | 0.189  | 0.172   | 0.0708    |
| traffic cone       | 1000   | 146       | 0.35   | 0.178  | 0.163   | 0.0842    | 0.362  | 0.164  | 0.142   | 0.0708    |
| traffic device     | 1000   | 70        | 0.153  | 0.0143 | 0.00819 | 0.00588   | 0.172  | 0.0143 | 0.00819 | 0.00402   |
| traffic light      | 1000   | 2757      | 0.127  | 0.46   | 0.287   | 0.151     | 0.102  | 0.352  | 0.195   | 0.0759    |
| traffic sign       | 1000   | 3067      | 0.485  | 0.378  | 0.357   | 0.23      | 0.425  | 0.306  | 0.284   | 0.125     |
| traffic sign frame | 1000   | 480       | 0.443  | 0.294  | 0.272   | 0.167     | 0.342  | 0.204  | 0.18    | 0.0824    |
| trailer            | 1000   | 8         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| train              | 1000   | 7         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| trash can          | 1000   | 8         | 0.0372 | 0.14   | 0.147   | 0.0912    | 0.0414 | 0.125  | 0.138   | 0.0725    |
| truck              | 1000   | 520       | 0.551  | 0.367  | 0.412   | 0.325     | 0.548  | 0.342  | 0.374   | 0.207     |
| tunnel             | 1000   | 7         | 0.335  | 0.286  | 0.292   | 0.26      | 0.346  | 0.286  | 0.292   | 0.188     |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.554  | 0.479  | 0.477   | 0.266     | 0.536  | 0.438  | 0.425   | 0.203     |
| wall               | 1000   | 286       | 0.257  | 0.0978 | 0.08    | 0.0474    | 0.275  | 0.0874 | 0.082   | 0.0443    |

## Base Model 
| Class              | Images | Instances | Box(P  | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|--------------------|--------|-----------|--------|--------|---------|-----------|--------|--------|---------|-----------|
| all                | 1000   | 67549     | 0.395  | 0.276  | 0.26    | 0.173     | 0.391  | 0.24   | 0.223   | 0.123     |
| banner             | 1000   | 729       | 0.305  | 0.21   | 0.151   | 0.0979    | 0.289  | 0.185  | 0.134   | 0.0622    |
| bicycle            | 1000   | 98        | 0.527  | 0.347  | 0.336   | 0.161     | 0.434  | 0.258  | 0.24    | 0.0857    |
| billboard          | 1000   | 144       | 0.115  | 0.229  | 0.0643  | 0.0431    | 0.112  | 0.201  | 0.0554  | 0.0258    |
| bridge             | 1000   | 212       | 0.413  | 0.387  | 0.353   | 0.213     | 0.315  | 0.259  | 0.217   | 0.0905    |
| building           | 1000   | 6742      | 0.478  | 0.321  | 0.337   | 0.185     | 0.48   | 0.292  | 0.312   | 0.149     |
| bus                | 1000   | 219       | 0.602  | 0.429  | 0.451   | 0.365     | 0.576  | 0.388  | 0.389   | 0.23      |
| bus stop           | 1000   | 3         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| car                | 1000   | 10829     | 0.757  | 0.713  | 0.766   | 0.564     | 0.678  | 0.608  | 0.652   | 0.355     |
| caravan            | 1000   | 52        | 0.331  | 0.192  | 0.172   | 0.15      | 0.353  | 0.179  | 0.168   | 0.115     |
| dynamic            | 1000   | 1350      | 0.468  | 0.114  | 0.151   | 0.0827    | 0.438  | 0.097  | 0.117   | 0.0539    |
| ego vehicle        | 1000   | 650       | 0.65   | 0.952  | 0.827   | 0.743     | 0.657  | 0.944  | 0.824   | 0.682     |
| fence              | 1000   | 453       | 0.322  | 0.307  | 0.204   | 0.0951    | 0.2    | 0.172  | 0.087   | 0.0344    |
| fire hydrant       | 1000   | 5         | 0.0635 | 0.4    | 0.156   | 0.101     | 0.0686 | 0.4    | 0.156   | 0.0809    |
| garage             | 1000   | 21        | 0      | 0      | 0.00892 | 0.00781   | 0      | 0      | 0.00892 | 0.00671   |
| ground             | 1000   | 851       | 0.442  | 0.11   | 0.136   | 0.0786    | 0.416  | 0.0917 | 0.0954  | 0.043     |
| guard rail         | 1000   | 503       | 0.528  | 0.348  | 0.368   | 0.228     | 0.496  | 0.308  | 0.312   | 0.162     |
| lane divider       | 1000   | 49        | 0.0794 | 0.0816 | 0.0234  | 0.0135    | 0.071  | 0.0612 | 0.0168  | 0.00663   |
| mail box           | 1000   | 6         | 0      | 0      | 0       | 0         | 0      | 0      | 0       | 0         |
| motorcycle         | 1000   | 47        | 0.61   | 0.468  | 0.49    | 0.338     | 0.601  | 0.449  | 0.484   | 0.272     |
| parking            | 1000   | 197       | 0.252  | 0.0914 | 0.0853  | 0.041     | 0.137  | 0.0406 | 0.0273  | 0.0134    |
| parking sign       | 1000   | 57        | 0.173  | 0.211  | 0.115   | 0.0909    | 0.223  | 0.226  | 0.125   | 0.0654    |
| person             | 1000   | 1177      | 0.736  | 0.572  | 0.646   | 0.407     | 0.703  | 0.509  | 0.577   | 0.282     |
| pole               | 1000   | 10720     | 0.463  | 0.257  | 0.257   | 0.135     | 0.455  | 0.226  | 0.231   | 0.0893    |
| polegroup          | 1000   | 237       | 0      | 0      | 0.00687 | 0.00381   | 0      | 0      | 0.00687 | 0.00339   |
| rail track         | 1000   | 4         | 0      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| rider              | 1000   | 45        | 0.635  | 0.4    | 0.461   | 0.269     | 0.513  | 0.311  | 0.3     | 0.085     |
| road               | 1000   | 1850      | 0.803  | 0.583  | 0.662   | 0.528     | 0.823  | 0.576  | 0.659   | 0.542     |
| sidewalk           | 1000   | 2035      | 0.541  | 0.407  | 0.413   | 0.244     | 0.562  | 0.386  | 0.385   | 0.187     |
| sky                | 1000   | 2546      | 0.627  | 0.507  | 0.552   | 0.405     | 0.646  | 0.488  | 0.539   | 0.378     |
| static             | 1000   | 8063      | 0.328  | 0.0825 | 0.102   | 0.0539    | 0.308  | 0.0681 | 0.0836  | 0.0371    |
| street light       | 1000   | 2157      | 0.426  | 0.187  | 0.172   | 0.0739    | 0.281  | 0.11   | 0.105   | 0.042     |
| terrain            | 1000   | 1075      | 0.433  | 0.257  | 0.26    | 0.139     | 0.424  | 0.222  | 0.224   | 0.0956    |
| traffic cone       | 1000   | 146       | 0.292  | 0.233  | 0.21    | 0.115     | 0.293  | 0.219  | 0.202   | 0.109     |
| traffic device     | 1000   | 70        | 0.23   | 0.0286 | 0.019   | 0.0104    | 0.146  | 0.0143 | 0.00705 | 0.00278   |
| traffic light      | 1000   | 2757      | 0.601  | 0.478  | 0.493   | 0.254     | 0.497  | 0.375  | 0.353   | 0.14      |
| traffic sign       | 1000   | 3067      | 0.492  | 0.441  | 0.415   | 0.267     | 0.427  | 0.356  | 0.327   | 0.147     |
| traffic sign frame | 1000   | 480       | 0.392  | 0.358  | 0.303   | 0.191     | 0.328  | 0.271  | 0.21    | 0.0944    |
| trailer            | 1000   | 8         | 0      | 0      | 0.00556 | 0.00445   | 0      | 0      | 0.00556 | 0.00556   |
| train              | 1000   | 7         | 1      | 0      | 0.0111  | 0.00887   | 1      | 0      | 0.0111  | 0.00998   |
| trash can          | 1000   | 8         | 0.0784 | 0.25   | 0.108   | 0.0494    | 0.0491 | 0.125  | 0.0783  | 0.0307    |
| truck              | 1000   | 520       | 0.557  | 0.496  | 0.487   | 0.391     | 0.542  | 0.456  | 0.446   | 0.253     |
| tunnel             | 1000   | 7         | 0.187  | 0.286  | 0.288   | 0.26      | 0.203  | 0.286  | 0.288   | 0.188     |
| unlabeled          | 1000   | 9         | 1      | 0      | 0       | 0         | 1      | 0      | 0       | 0         |
| vegetation         | 1000   | 7058      | 0.563  | 0.496  | 0.507   | 0.295     | 0.557  | 0.457  | 0.457   | 0.222     |
| wall               | 1000   | 286       | 0.292  | 0.182  | 0.136   | 0.079     | 0.308  | 0.171  | 0.131   | 0.0677    |