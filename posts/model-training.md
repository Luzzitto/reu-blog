---
title: "Model Training"
subtitle: "Training a clean model"
date: "2023-10-04"
---

# Changes in Model Training

## 1. Slurm file
Previous Slurm
![previous_slurm.png](/images/previous_slurm.png)
New Slurm
![new_slurm.png](/images/new_slurm.png)

## 2. Code Modification
Previous Code
![code_previous.png](/images/code_previous.png)
New Code
![code_new.png](/images/code_new.png)

## 3. Model Evaluation
`/home/ltupa001/research/w6/train_model`

| Class         | Images | Instances | Box(P | R     | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|---------------|--------|-----------|-------|-------|---------|-----------|--------|--------|---------|-----------|
| road          | 1000   | 1850      | 0.779 | 0.583 | 0.637   | 0.316     | 0.76   | 0.559  | 0.606   | 0.328     |
| sidewalk      | 1000   | 2035      | 0.551 | 0.429 | 0.432   | 0.25      | 0.553  | 0.416  | 0.409   | 0.189     |
| building      | 1000   | 6742      | 0.524 | 0.38  | 0.399   | 0.227     | 0.521  | 0.366  | 0.375   | 0.185     |
| wall          | 1000   | 287       | 0.279 | 0.105 | 0.11    | 0.063     | 0.298  | 0.101  | 0.107   | 0.0604    |
| fence         | 1000   | 453       | 0.313 | 0.287 | 0.195   | 0.094     | 0.214  | 0.188  | 0.0975  | 0.0386    |
| pole          | 1000   | 10725     | 0.484 | 0.294 | 0.289   | 0.146     | 0.46   | 0.27   | 0.248   | 0.0806    |
| traffic light | 1000   | 2758      | 0.653 | 0.437 | 0.47    | 0.237     | 0.629  | 0.414  | 0.442   | 0.193     |
| traffic sign  | 1000   | 3068      | 0.526 | 0.384 | 0.376   | 0.228     | 0.512  | 0.366  | 0.359   | 0.175     |
| vegetation    | 1000   | 7060      | 0.583 | 0.505 | 0.529   | 0.314     | 0.562  | 0.474  | 0.48    | 0.24      |
| terrain       | 1000   | 1075      | 0.479 | 0.232 | 0.244   | 0.122     | 0.432  | 0.203  | 0.201   | 0.085     |
| sky           | 1000   | 2546      | 0.525 | 0.582 | 0.54    | 0.334     | 0.532  | 0.576  | 0.546   | 0.351     |
| person        | 1000   | 1177      | 0.662 | 0.569 | 0.612   | 0.346     | 0.645  | 0.548  | 0.575   | 0.241     |
| rider         | 1000   | 45        | 0.416 | 0.244 | 0.222   | 0.0926    | 0.244  | 0.133  | 0.0943  | 0.0143    |
| **car**           | **1000**   | **10833**     | **0.723** | **0.721** | **0.757**   | **0.554**     | **0.671**  | **0.659**  | **0.682**   | **0.392**     |
| truck         | 1000   | 521       | 0.488 | 0.447 | 0.408   | 0.309     | 0.493  | 0.44   | 0.393   | 0.228     |
| bus           | 1000   | 219       | 0.428 | 0.4   | 0.346   | 0.269     | 0.412  | 0.378  | 0.331   | 0.204     |
| train         | 1000   | 7         | 1     | 0     | 0.00898 | 0.00719   | 1      | 0      | 0.00898 | 0.00719   |
| motorcycle    | 1000   | 47        | 0.369 | 0.17  | 0.253   | 0.162     | 0.434  | 0.191  | 0.254   | 0.083     |
| bicycle       | 1000   | 99        | 0.222 | 0.101 | 0.113   | 0.0442    | 0.136  | 0.0606 | 0.0521  | 0.0147    |

`/home/ltupa001/repo/composite-backdoor-percentage`

| Class      | Images | Instances | Box(P | R      | mAP50   | mAP50-95) | Mask(P | R      | mAP50   | mAP50-95) |
|------------|--------|-----------|-------|--------|---------|-----------|--------|--------|---------|-----------|
| all        | 1000   | 13002     | 0.681 | 0.4    | 0.437   | 0.31      | 0.662  | 0.382  | 0.406   | 0.246     |
| bicycle    | 1000   | 98        | 0.536 | 0.398  | 0.379   | 0.171     | 0.513  | 0.378  | 0.33    | 0.141     |
| bus        | 1000   | 219       | 0.647 | 0.461  | 0.505   | 0.41      | 0.649  | 0.461  | 0.504   | 0.376     |
| **car**        | **1000**   | **10829**     | **0.808** | **0.766**  | **0.828**   | **0.62**      | **0.777**  | **0.729**  | **0.779**   | **0.487**     |
| caravan    | 1000   | 52        | 0.697 | 0.0962 | 0.212   | 0.188     | 0.704  | 0.0962 | 0.212   | 0.178     |
| motorcycle | 1000   | 47        | 0.693 | 0.489  | 0.553   | 0.416     | 0.705  | 0.489  | 0.531   | 0.321     |
| person     | 1000   | 1177      | 0.791 | 0.681  | 0.752   | 0.483     | 0.776  | 0.662  | 0.733   | 0.393     |
| rider      | 1000   | 45        | 0.731 | 0.483  | 0.519   | 0.311     | 0.591  | 0.386  | 0.375   | 0.149     |
| trailer    | 1000   | 8         | 0.287 | 0.125  | 0.048   | 0.0414    | 0.299  | 0.125  | 0.048   | 0.042     |
| train      | 1000   | 7         | 1     | 0      | 0.00515 | 0.00412   | 1      | 0      | 0.00515 | 0.00412   |
| truck      | 1000   | 520       | 0.617 | 0.502  | 0.566   | 0.456     | 0.611  | 0.49   | 0.545   | 0.374     |


`C:\Users\luzzi\Documents\apps\python\composite_backdoor_percentage`

| Class      | Images | Instances | Box(P | R     | mAP50   | mAP50-95) | Mask(P | R     | mAP50   | mAP50-95) |
|------------|--------|-----------|-------|-------|---------|-----------|--------|-------|---------|-----------|
| all        | 1000   | 13002     | 0.695 | 0.38  | 0.453   | 0.32      | 0.678  | 0.351 | 0.415   | 0.258     |
| bicycle    | 1000   | 98        | 0.608 | 0.285 | 0.346   | 0.168     | 0.537  | 0.235 | 0.256   | 0.103     |
| bus        | 1000   | 219       | 0.743 | 0.447 | 0.536   | 0.432     | 0.751  | 0.443 | 0.53    | 0.396     |
| **car**        | **1000**   | **10829**     | **0.886** | **0.719** | **0.833**   | **0.628**     | **0.86**   | **0.68**  | **0.784**   | **0.499**     |
| caravan    | 1000   | 52        | 0.371 | 0.154 | 0.221   | 0.193     | 0.405  | 0.154 | 0.221   | 0.187     |
| motorcycle | 1000   | 47        | 0.803 | 0.521 | 0.62    | 0.423     | 0.734  | 0.469 | 0.549   | 0.336     |
| person     | 1000   | 1177      | 0.884 | 0.624 | 0.761   | 0.49      | 0.876  | 0.598 | 0.727   | 0.399     |
| rider      | 1000   | 45        | 0.8   | 0.467 | 0.51    | 0.28      | 0.667  | 0.355 | 0.384   | 0.154     |
| trailer    | 1000   | 8         | 0.174 | 0.125 | 0.135   | 0.119     | 0.254  | 0.125 | 0.135   | 0.121     |
| train      | 1000   | 7         | 1     | 0     | 0.00522 | 0.00358   | 1      | 0     | 0.00532 | 0.00387   |
| truck      | 1000   | 520       | 0.683 | 0.46  | 0.566   | 0.46      | 0.692  | 0.448 | 0.555   | 0.386     |

## 4. Model Training Output
`/home/ltupa001/research/w6/train_model`

![hpc_reu_results.png](/images/hpc_reu_results.png)

`/home/ltupa001/repo/composite-backdoor-percentage`
![clean_model_hpc_results.png](/images/clean_model_hpc_results.png)

`C:\Users\luzzi\Documents\apps\python\composite_backdoor_percentage`
![clean_model_pc_results.png](/images/clean_model_pc_results.png)